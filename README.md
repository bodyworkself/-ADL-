# -ADL-
脳卒中リハビリにおけるFIMの予後予測アプリ
# ADL 予後予測（個人利用・教育用）

> 2点法（A/B）から回復速度 β を推定し、予測日 X の FIM-m を推定。  
> 自宅退院確率 p̂・信頼区間（CI）・最有力レバー（Δp最大）・項目別5点到達を可視化します。

---

## ⚠️ 重要な注意（免責）

**本ツールは医療機器ではありません。臨床判断・診断・治療方針の決定には使用できません。**  
教育・ディスカッション目的で提供され、推定は近似モデルです。**外部妥当化・校正は未実施**です。最終判断は多職種チームで行ってください。

---

## スクリーンショット
（スクショを `docs/images` に置いて挿入）
![screenshot](docs/images/app-main.png)

---

## 主な機能

- **予測**: 2点法 β → 予測日 X の FIM-m（91点でクリップ）
- **自宅退院確率 p̂ + CI**（ブートストラップ近似）
- **高確度モード**: しきい値（自宅≥/非自宅≤）を設定
- **最有力レバー**: Δp（確率差）が最大の介入候補を提示（FIM±5、同居/段差等）
- **項目別 5点到達確率**: 到達難易度の高い項目を特定して重点化
- **自己テスト**: 数学的整合性・境界チェックをワンクリック検証
- **エビデンス一覧**: 「高次脳機能障害がFIM回復に与える要因の検討」リンク集（原著へ）

---

## 仕組み（要約）

- **β推定**: `β = (FIM_B − FIM_A) / (ln(B) − ln(A))`  
- **FIM推定**: `FIM_X = FIM_A + β * (ln(X) − ln(A))`（0–91でクリップ）
- **自宅退院 p̂**: ロジスティック近似（年齢・同居・段差・NIHSSレンジ・mRS等を加味）
- **ヒューリスティック**: wNeg / wAph / wApx はデフォルト0（**厳密モード**）  
  - 値を入れると**仮想的な不利寄与**を項目しきい値調整に反映（教育目的）
- **感度分析（CI）**: 測定誤差±2、係数揺らぎ、小分類（NIHSS不明=low/mid/high）でpの分布から 90%CI を近似

> 詳細仕様は `docs/SPEC.md` を参照（係数の出典の考え方／ヒューリスティックの意味／感度分析の前提）。

---

## エビデンス（原著の一部）

- Koyama T, et al. *Clin Rehabil*. 2005;19:779–789.（二点法×対数モデルの回復曲線）
- Koyama T, et al. *J Stroke Cerebrovasc Dis*. 2011;20:202–207.（自宅退院予測因子）
- 〔注意/遂行〕**TMT-Aの追加で再分類改善**（IDI=0.034）  
  JGTS 2024: https://www.jstage.jst.go.jp/article/jgts/4/0/4_2024_012_OA/_article/-char/en
- 〔遂行〕*Brain Sciences* 2023：TMT-BとFIMの関連（横断）  
  https://www.mdpi.com/2076-3425/13/4/627
- 〔失行〕*Neurology Asia* 2020：失行群は入退院FIMが低め（gain差は小〜非有意）  
  https://www.neurology-asia.org/articles/neuroasia-2020-25(4)-459.pdf
- 〔失行〕*Top Stroke Rehabil* 2014：入院リハで失行患者の到達FIMが低い（後ろ向き）  
  PMID: 24985388

> **リンクが開かない場合**：ブラウザのポップアップブロックを解除するか、URLをコピーして新しいタブに貼り付けてください。

---

## プライバシー

- 本アプリは**外部送信を行いません**。処理はブラウザ内で完結します。
- `localStorage` 使用キー
  - `adl_state_v1`：入力状態
  - `adl-consent-v1`：初回同意フラグ
- 個人識別情報は保存・送信しません。

---

## 動作環境

- Node.js **>= 18**
- 推奨ブラウザ：最新の Chrome / Edge / Safari

---

## セットアップ

```bash
# 1) 取得
git clone https://github.com/<your-org>/<repo>.git
cd <repo>

# 2) 依存関係
# どれか一つ
npm i
# or
yarn
# or
pnpm i

# 3) 開発サーバ
npm run dev
# http://localhost:5173 など（Vite想定）

# 4) ビルド
npm run build

# 5) ローカルプレビュー
npm run preview
